# 家庭功能测试检查清单

## 快速测试指南

### 准备工作
- [ ] 确认后端服务可访问: `http://139.129.108.119:8080`
- [ ] 准备至少两个测试账号
- [ ] 准备两台测试设备（或使用模拟器）

---

## 一、基础功能测试

### 1.1 创建家庭
| 步骤 | 操作 | 预期结果 | 实际结果 | 通过 |
|------|------|----------|----------|------|
| 1 | 用户A登录 | 成功获取Token | | |
| 2 | 点击"创建家庭" | 进入创建页面 | | |
| 3 | 输入家庭名"测试家庭" | 输入成功 | | |
| 4 | 点击确认创建 | 创建成功，返回首页 | | |
| 5 | 检查用户角色 | 显示为"管理员" | | |

**测试账号**: 13800138000 / abc123456

### 1.2 获取邀请码
| 步骤 | 操作 | 预期结果 | 实际结果 | 通过 |
|------|------|----------|----------|------|
| 1 | 点击"家庭二维码" | 进入二维码页面 | | |
| 2 | 检查二维码显示 | 显示二维码图片 | | |
| 3 | 检查邀请码显示 | 显示6位邀请码 | | |
| 4 | 记录邀请码 | 保存用于后续测试 | | |

### 1.3 加入家庭
| 步骤 | 操作 | 预期结果 | 实际结果 | 通过 |
|------|------|----------|----------|------|
| 1 | 用户B登录 | 成功获取Token | | |
| 2 | 点击"加入家庭" | 进入加入页面 | | |
| 3 | 输入邀请码 | 输入成功 | | |
| 4 | 点击预览 | 显示家庭信息 | | |
| 5 | 点击确认加入 | 加入成功，返回首页 | | |
| 6 | 检查用户角色 | 显示为"普通成员" | | |

**测试账号**: 13900139000 / xyz123456

### 1.4 成员列表同步
| 步骤 | 操作 | 预期结果 | 实际结果 | 通过 |
|------|------|----------|----------|------|
| 1 | 用户A查看成员列表 | 显示2个成员 | | |
| 2 | 用户B查看成员列表 | 显示2个成员 | | |
| 3 | 双方核对成员信息 | 信息一致 | | |

---

## 二、权限控制测试

### 2.1 管理员权限
| 操作 | 预期结果 | 实际结果 | 通过 |
|------|----------|----------|------|
| 获取家庭二维码 | 成功显示 | | |
| 更新家庭名称 | 成功更新 | | |
| 移除成员 | 成功移除 | | |
| 查看成员列表 | 显示所有成员 | | |

### 2.2 普通成员权限
| 操作 | 预期结果 | 实际结果 | 通过 |
|------|----------|----------|------|
| 获取家庭二维码 | 提示无权限 | | |
| 更新家庭名称 | 提示无权限 | | |
| 移除成员 | 提示无权限 | | |
| 退出家庭 | 成功退出 | | |

---

## 三、边界条件测试

### 3.1 输入验证
| 测试项 | 输入 | 预期结果 | 实际结果 | 通过 |
|--------|------|----------|----------|------|
| 空家庭名 | 空字符串 | 提示"不能为空" | | |
| 超长家庭名 | 101个字符 | 提示"最多100字符" | | |
| 空邀请码 | 空字符串 | 提示"不能为空" | | |
| 小写邀请码 | abc123 | 提示"格式错误" | | |
| 无效邀请码 | ZZZZZZ | 提示"邀请码无效" | | |

### 3.2 状态验证
| 测试项 | 状态 | 操作 | 预期结果 | 实际结果 | 通过 |
|--------|------|------|----------|----------|------|
| 无家庭加入 | 未加入家庭 | 获取家庭信息 | 提示"未加入家庭" | | |
| 重复加入 | 已有家庭 | 尝试加入其他 | 提示"已有家庭" | | |
| 管理员退出 | 角色为管理员 | 尝试退出 | 提示"无法退出" | | |
| 被移除访问 | 被管理员移除 | 获取家庭信息 | 提示"未加入家庭" | | |

---

## 四、双设备协作测试

### 测试场景
**设备A**: 用户A (管理员)
**设备B**: 用户B (普通成员)

| 步骤 | 设备A操作 | 设备B操作 | 验证点 | 通过 |
|------|-----------|-----------|--------|------|
| 1 | 创建家庭 | - | 家庭创建成功 | |
| 2 | 获取邀请码 | 输入邀请码 | 预览信息正确 | |
| 3 | 等待加入 | 确认加入 | 双方看到2个成员 | |
| 4 | 更新家庭名 | 刷新页面 | 设备B看到新名称 | |
| 5 | 查看成员列表 | 查看成员列表 | 双方列表一致 | |
| 6 | 移除设备B用户 | 刷新页面 | 设备B无家庭信息 | |

---

## 五、完整测试流程

### 流程A: 创建-加入-退出
```
用户A ──────> 创建家庭 ──────> 获取邀请码
                                        │
                                        ▼
用户B ──────> 输入邀请码 ──────> 加入家庭 ──────> 查看成员
                                        │
                                        ▼
用户B ──────> 退出家庭 ──────> 验证无家庭
```

### 流程B: 创建-邀请-移除
```
用户A ──────> 创建家庭 ──────> 获取邀请码
                                        │
                                        ▼
用户B ──────> 加入家庭 ──────> 成为成员
                                        │
                                        ▼
用户A ──────> 移除成员B ──────> 成员减少
```

---

## 六、API快速测试命令

### 6.1 登录
```bash
curl -X POST "http://139.129.108.119:8080/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"phone":"13800138000","password":"abc123456"}'
```

### 6.2 创建家庭
```bash
curl -X POST "http://139.129.108.119:8080/api/family/create" \
  -H "Content-Type: application/json" \
  -H "X-User-Id: {用户ID}" \
  -d '{"familyName":"测试家庭"}'
```

### 6.3 获取二维码
```bash
curl -X GET "http://139.129.108.119:8080/api/family/qrcode" \
  -H "X-User-Id: {用户ID}"
```

### 6.4 加入家庭
```bash
curl -X POST "http://139.129.108.119:8080/api/family/join" \
  -H "Content-Type: application/json" \
  -H "X-User-Id: {用户ID}" \
  -d '{"inviteCode":"ABC123"}'
```

### 6.5 获取成员列表
```bash
curl -X GET "http://139.129.108.119:8080/api/family/members" \
  -H "X-User-Id: {用户ID}"
```

### 6.6 移除成员
```bash
curl -X DELETE "http://139.129.108.119:8080/api/family/members/{目标用户ID}" \
  -H "X-User-Id: {管理员ID}"
```

### 6.7 退出家庭
```bash
curl -X POST "http://139.129.108.119:8080/api/family/leave" \
  -H "X-User-Id: {用户ID}"
```

---

## 七、问题记录

### 发现的问题
| ID | 问题描述 | 严重程度 | 状态 |
|----|----------|----------|------|
| | P0-致命 | | |
| | P1-严重 | | |
| | P2-一般 | | |
| | P3-轻微 | | |

### 建议优化
| ID | 优化建议 | 优先级 | 状态 |
|----|----------|--------|------|
| | 高 | | |
| | 中 | | |
| | 低 | | |

---

## 八、测试总结

### 测试完成情况
- 计划测试用例数: ____ 个
- 实际执行用例数: ____ 个
- 通过用例数: ____ 个
- 失败用例数: ____ 个
- 通过率: ____ %

### 测试结论
- [ ] 通过 - 可以发布
- [ ] 有条件通过 - 需修复P0/P1问题
- [ ] 不通过 - 需要重新测试

### 测试签名
- 测试人员: _____________
- 测试日期: _____________
- 审核人员: _____________
